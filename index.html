<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='apple-mobile-web-app-capable' content='yes' />
    <meta name='viewport' content='initial-scale=1.0, maximum-scale=1.0, user-scalable=0, width=device-width, height=device-height' />
    <meta name='apple-mobile-web-app-status-bar-style' content='black-translucent' />
    <title>No-Scroll Yahtzee Scoreboard</title>
     <link rel="canonical" href="https://williac0374.github.io/html-apps/" />
  <link rel="manifest" href="/html-apps/manifest.webmanifest">
    <style>
        /* CSS for mobile-first, no-scroll design */
        html, body {
            height: 100%; /* Important for no-scroll constraint */
            margin: 0;
            padding: 0;
            overflow: hidden; /* THE KEY: Prevents scrolling */
            font-family: Arial, sans-serif;
            background-color: #343a40; /* Dark background */
            color: #fff;
            display: flex;
            flex-direction: column;
        }

        /* 1. HEADER (Takes minimal space) */
        header {
            padding: 8px 0;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            background-color: #212529;
            cursor: pointer; /* Indicate it's clickable for reset */
            user-select: none; /* Prevent text selection on click */
        }

        /* 2. MAIN GRID (Core scoring area) */
        #main-container {
            flex-grow: 1; /* Allows it to fill the remaining space */
            display: grid;
            /* 1 column for categories, 2 for players */
            grid-template-columns: 1fr 0.7fr 0.7fr; 
            grid-auto-rows: minmax(0, 1fr); /* Distribute rows equally */
            padding: 5px;
            overflow: hidden; /* Redundant, but safe */
        }
        
        .cell {
            border: 1px solid #495057;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2px;
            font-size: 0.8em;
            overflow: hidden; /* Truncate long text if necessary */
        }

        /* Player Names - Click to Edit */
        .player-name {
            background-color: #007bff;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
        }

        /* Category Names - Left Column */
        .category-label {
            background-color: #495057;
            text-align: left;
            padding-left: 5px;
            justify-content: flex-start;
        }

        /* Score Input Fields */
        input[type="number"] {
            width: 90%;
            height: 90%;
            padding: 0;
            margin: 0;
            border: none;
            text-align: center;
            background-color: #fff;
            color: #333;
            font-weight: bold;
            font-size: 0.9em;
            -moz-appearance: textfield; /* Hide arrows on Firefox */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none; /* Hide arrows on Chrome/Safari */
            margin: 0;
        }
        
        /* 3. FOOTER (Totals Display) */
        footer {
            display: grid;
            grid-template-columns: 1fr 1fr;
            padding: 10px 5px;
            background-color: #1e7e34; /* Green for final totals */
            font-weight: bold;
        }
        .final-total {
            text-align: center;
            font-size: 1.2em;
        }
        .total-label {
            font-size: 0.7em;
            margin-bottom: 2px;
            opacity: 0.8;
        }
    </style>
</head>
<body>

    <header onclick="resetScorecard()">YAHTZEE SCOREBOARD</header> 

    <div id="main-container">
        <div class="cell category-label">CATEGORY</div>
        <div class="cell player-name" contenteditable="true" id="p1_name_cell" title="Click to rename Player 1" oninput="saveScorecard()">P1</div>
        <div class="cell player-name" contenteditable="true" id="p2_name_cell" title="Click to rename Player 2" oninput="saveScorecard()">P2</div>

        <div class="cell category-label">Ones (1)</div><div class="cell"><input type="number" id="p1_ones" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_ones" oninput="calculateScore()"></div>
        <div class="cell category-label">Twos (2)</div><div class="cell"><input type="number" id="p1_twos" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_twos" oninput="calculateScore()"></div>
        <div class="cell category-label">Threes (3)</div><div class="cell"><input type="number" id="p1_threes" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_threes" oninput="calculateScore()"></div>
        <div class="cell category-label">Fours (4)</div><div class="cell"><input type="number" id="p1_fours" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_fours" oninput="calculateScore()"></div>
        <div class="cell category-label">Fives (5)</div><div class="cell"><input type="number" id="p1_fives" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_fives" oninput="calculateScore()"></div>
        <div class="cell category-label">Sixes (6)</div><div class="cell"><input type="number" id="p1_sixes" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_sixes" oninput="calculateScore()"></div>
        
        <div class="cell category-label">3 Knd</div><div class="cell"><input type="number" id="p1_3ofakind" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_3ofakind" oninput="calculateScore()"></div>
        <div class="cell category-label">4 Knd</div><div class="cell"><input type="number" id="p1_4ofakind" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_4ofakind" oninput="calculateScore()"></div>
        <div class="cell category-label">FH (25)</div><div class="cell"><input type="number" id="p1_fullhouse" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_fullhouse" oninput="calculateScore()"></div>
        <div class="cell category-label">SS (30)</div><div class="cell"><input type="number" id="p1_smstraight" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_smstraight" oninput="calculateScore()"></div>
        <div class="cell category-label">LS (40)</div><div class="cell"><input type="number" id="p1_lgstraight" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_lgstraight" oninput="calculateScore()"></div>
        <div class="cell category-label">Chance</div><div class="cell"><input type="number" id="p1_chance" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_chance" oninput="calculateScore()"></div>
        <div class="cell category-label">Ytz (50)</div><div class="cell"><input type="number" id="p1_yatzee" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_yatzee" oninput="calculateScore()"></div>
        <div class="cell category-label">Ytz Bns</div><div class="cell"><input type="number" id="p1_yatzee_bonus" oninput="calculateScore()"></div><div class="cell"><input type="number" id="p2_yatzee_bonus" oninput="calculateScore()"></div>
        <div class="cell category-label">Upper Bns</div><div class="cell" id="p1_bonus_upper">0</div><div class="cell" id="p2_bonus_upper">0</div>

        </div>

    <footer>
        <div class="final-total">
            <div class="total-label">P1 GRAND TOTAL</div>
            <div id="p1_grand_total">0</div>
        </div>
        <div class="final-total">
            <div class="total-label">P2 GRAND TOTAL</div>
            <div id="p2_grand_total">0</div>
        </div>
    </footer>


    <script>
        // List of all score input IDs (only the category part)
        const SCORE_CATEGORIES = [
            "ones", "twos", "threes", "fours", "fives", "sixes",
            "3ofakind", "4ofakind", "fullhouse", "smstraight", "lgstraight", "chance", "yatzee", "yatzee_bonus"
        ];
        const PLAYERS = ['p1', 'p2'];
        
        // --- LOCAL STORAGE LOGIC ---
        
        /**
         * Saves the current state of the scoreboard to localStorage.
         */
        function saveScorecard() {
            const yatzeeData = {
                scores: {},
                names: {}
            };

            // 1. Save Player Names
            yatzeeData.names.p1 = document.getElementById('p1_name_cell').textContent;
            yatzeeData.names.p2 = document.getElementById('p2_name_cell').textContent;

            // 2. Save Scores
            for (const player of PLAYERS) {
                for (const category of SCORE_CATEGORIES) {
                    const id = `${player}_${category}`;
                    const inputElement = document.getElementById(id);
                    // Save the raw value from the input field
                    yatzeeData.scores[id] = inputElement ? inputElement.value : '';
                }
            }

            try {
                localStorage.setItem('yatzee', JSON.stringify(yatzeeData));
            } catch (e) {
                console.error("Error saving to localStorage", e);
            }
        }
        
        /**
         * Loads the saved state from localStorage and populates the scoreboard.
         */
        function loadScorecard() {
            const savedData = localStorage.getItem('yatzee');
            
            if (savedData) {
                try {
                    const yatzeeData = JSON.parse(savedData);
                    
                    // 1. Restore Player Names
                    if (yatzeeData.names) {
                        document.getElementById('p1_name_cell').textContent = yatzeeData.names.p1 || 'P1';
                        document.getElementById('p2_name_cell').textContent = yatzeeData.names.p2 || 'P2';
                    }

                    // 2. Restore Scores
                    if (yatzeeData.scores) {
                        for (const player of PLAYERS) {
                            for (const category of SCORE_CATEGORIES) {
                                const id = `${player}_${category}`;
                                const inputElement = document.getElementById(id);
                                if (inputElement && yatzeeData.scores[id] !== undefined) {
                                    // Set the value back into the input field
                                    inputElement.value = yatzeeData.scores[id];
                                }
                            }
                        }
                    }

                } catch (e) {
                    console.error("Error parsing or loading data from localStorage", e);
                    // Clear corrupted data
                    localStorage.removeItem('yatzee'); 
                }
            }
            
            // Recalculate totals after loading/initial setup
            calculateScore();
        }

        /**
         * Clears the scorecard and removes saved data after user confirmation.
         */
        function resetScorecard() {
            const confirmation = confirm("Are you sure you want to reset the scorecard? This will clear all scores and names.");
            
            if (confirmation) {
                // 1. Clear all input fields
                for (const player of PLAYERS) {
                    for (const category of SCORE_CATEGORIES) {
                        const id = `${player}_${category}`;
                        const inputElement = document.getElementById(id);
                        if (inputElement) {
                            inputElement.value = '';
                        }
                    }
                }
                
                // 2. Reset Player Names
                document.getElementById('p1_name_cell').textContent = 'P1';
                document.getElementById('p2_name_cell').textContent = 'P2';

                // 3. Clear localStorage data
                localStorage.removeItem('yatzee');
                
                // 4. Recalculate to clear all displayed totals
                calculateScore();

                alert("Scorecard has been reset!");
            }
        }

        // --- SCORING LOGIC (Slightly modified to call saveScorecard) ---
        
        function calculatePlayerScore(playerPrefix) {
            let upperSum = 0;
            const upperCategories = ["ones", "twos", "threes", "fours", "fives", "sixes"];
            
            // 1. Calculate Upper Sum
            for (const category of upperCategories) {
                const inputId = `${playerPrefix}_${category}`;
                // Get the value, convert to number, default to 0 if empty or not a number
                const value = parseInt(document.getElementById(inputId).value) || 0;
                upperSum += value;
            }

            // 2. Calculate Upper Bonus
            const upperBonus = upperSum >= 63 ? 35 : 0;
            
            // 3. Calculate Total Upper Score - not explicitly needed for grand total, but useful conceptually

            // Update Upper Bonus display
            document.getElementById(`${playerPrefix}_bonus_upper`).textContent = upperBonus;

            // 4. Calculate Lower Sum
            let lowerSum = 0;
            const lowerCategories = ["3ofakind", "4ofakind", "fullhouse", "smstraight", "lgstraight", "yatzee", "chance"];
            const lowerBonusCategory = "yatzee_bonus";
            
            for (const category of lowerCategories) {
                const inputId = `${playerPrefix}_${category}`;
                const value = parseInt(document.getElementById(inputId).value) || 0;
                lowerSum += value;
            }

            // Add Yahtzee Bonus
            const yatzeeBonus = parseInt(document.getElementById(`${playerPrefix}_${lowerBonusCategory}`).value) || 0;
            lowerSum += yatzeeBonus; 
            
            // 5. Total Lower Score is just the Lower Sum (including bonus)
            const totalLower = lowerSum;

            // 6. Calculate Grand Total
            const grandTotal = upperSum + upperBonus + totalLower; // Total Upper (Sum + Bonus) + Total Lower (Sum + Yahtzee Bonus)
            document.getElementById(`${playerPrefix}_grand_total`).textContent = grandTotal;
        }

        // Master function called on every input change
        function calculateScore() {
            calculatePlayerScore('p1');
            calculatePlayerScore('p2');
            saveScorecard(); // <-- NEW: Save the state every time a score changes
        }

        // Initial setup: Load from storage, then calculate totals
        window.onload = loadScorecard; // <-- NEW: Load from storage instead of just calculating

    </script>
</body>
</html>
